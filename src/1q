"use client";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { useState } from "react";
import { authClient } from "@/lib/auth-client";
export default function Home() {
	const {
        	data: session,
        	isPending, //loading state
        	error, //error object
        	refetch //refetch the session
    	} = authClient.useSession();
	const [email,setEmail] = useState("");
	const [password,setPassword] = useState("");
	const [name,setName] = useState("");
	const onSubmit=()=>{
		authClient.signUp.email({
			email,
			password,
			name
		},{
			onError:(error)=>{
					window.alert("Error:");
			},
			onSuccess:()=>{
					window.alert("Success:");
			}
		})
	}
	const onLogin=()=>{
		authClient.signIn.email({
			email,
			password
		},{
			onError:(error)=>{
				window.alert("Error:this is error")
			}
			,onSuccess:()=>{
				window.alert("Success:you are logged in")
			}
		})
	}
	if(session){
		return (
		<div className="flex flex-col p-4 gap-y-4">
			<p>Logged In as  {session.user.name}</p>
			<Button onClick={()=>authClient.signOut()}>SignOut</Button>
		</div>
		)
	}
	
	return (
	     <div className="flex flex-col gap-4 w-[300px] mx-auto mt-20">
             	<Input placeholder="Email" value={email} onChange={(e) => setEmail(e.target.value)} />
             	<Input placeholder="Password" type="password" value={password} onChange={(e) => setPassword(e.target.value)} />
             	<Button onClick={onLogin}>
            	 Login
		 </Button>
	     </div>

	     <div className="flex flex-col gap-4 w-[300px] mx-auto mt-20">
	     	<Input placeholder="Name" value={name} onChange={(e) => setName(e.target.value)} />
	    	<Input placeholder="Email" value={email} onChange={(e) => setEmail(e.target.value)} />
	     	<Input placeholder="Password" type="password" value={password} onChange={(e) => setPassword(e.target.value)} />
	     	<Button 
	     		onClick={onSubmit}>
	     		Sign Up
	     	</Button>

	    </div>

  );
}
